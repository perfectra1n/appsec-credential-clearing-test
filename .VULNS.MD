# `.vulns.yml`

**A specification for declaring vulnerabilities in intentionally
vulnerable applications ("vulnapps") to help scanners assess their own
find rate.**

## Usage Concept

1. A **vulnerable application** declares its vulnerabilities in an
   agreed schema in a `.vulns.yml` (or `.vulns.json`) file
2. A **security scanner** analyzes the vulnapp and generates a report
   with its findings
3. The individual findings in the report are checked for _flags_
   specified in `.vulns.yml` to assess them as false negative/positive
   or true positive

## Schema Drafts

1. https://github.com/bkimminich/juice-shop/blob/develop/.vulns.flags-only.yml:
   Flags only, no further grouping or categorization
2. https://github.com/bkimminich/juice-shop/blob/develop/.vulns.subtyped-flags.yml:
   Flags categorized into different types
3. https://github.com/bkimminich/juice-shop/blob/develop/.vulns.grouped-flags.yml:
   Flags grouped by their location of occurence with optional extra
   attributes (like HTTP method)

## Draft Comparison

| Draft          | Declaration EEffort       | Flag Duplication          | Report Matching Effort    | Assessment Precision     | Extensibility            |
|:---------------|:--------------------------|:--------------------------|:--------------------------|:-------------------------|:-------------------------|
| Flags only     | Low (:heavy_plus_sign:)   | Low (:heavy_plus_sign:)   | Low (:heavy_plus_sign:)   | Low (:heavy_minus_sign:) | Low (:heavy_minus_sign:) |
| Subtyped flags | Medium                    | Medium                    | High (:heavy_minus_sign:) | Medium                   | Medium                   |
| Grouped flags  | High (:heavy_minus_sign:) | High (:heavy_minus_sign:) | Medium                    | High (:heavy_plus_sign:) | High (:heavy_plus_sign:) |

## Discussion

<https://github.com/bkimminich/juice-shop/issues/1441>
